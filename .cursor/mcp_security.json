{
  "security_config": {
    "version": "2.0.1",
    "description": "出力セキュリティ・環境保護設定 - 強化版",
    "last_updated": "2025-01-27",
    "enforcement_level": "strict",
    "auto_enable": true
  },
  "output_restrictions": {
    "allowed_directories": [
      "outputs/",
      "generated/",
      "results/",
      "temp/",
      "logs/",
      "backups/",
      "uploads/"
    ],
    "blocked_directories": [
      ".env",
      ".env.*",
      "secrets/",
      "config/private/",
      "credentials/",
      "keys/",
      ".git/",
      "node_modules/",
      "venv/",
      "__pycache__/",
      ".cursor/",
      "config_backup_0808/"
    ],
    "file_extensions": {
      "allowed": [".txt", ".md", ".json", ".csv", ".xml", ".yaml", ".yml", ".py", ".js", ".ts", ".html", ".css", ".log"],
      "blocked": [".env", ".key", ".pem", ".p12", ".pfx", ".crt", ".pem", ".p8", ".secret", ".token"]
    },
    "max_file_size_mb": 10,
    "max_output_files_per_session": 50,
    "prevent_env_file_creation": true,
    "strict_directory_protection": true
  },
  "environment_protection": {
    "protected_files": [
      ".env",
      ".env.local",
      ".env.production",
      ".env.development",
      ".env.test",
      ".env.bak",
      ".env.docker",
      "secrets.json",
      "config.json",
      "credentials.json",
      "api_keys.json",
      "honest_security_test.env"
    ],
    "protected_patterns": [
      "*.key",
      "*.pem",
      "*.crt",
      "*.p12",
      "secrets/*",
      "private/*",
      "credentials/*",
      ".env*"
    ],
    "read_only_files": [
      ".gitignore",
      "README.md",
      "LICENSE",
      "requirements.txt",
      "package.json",
      "env.example"
    ],
    "env_file_protection": {
      "block_env_file_creation": true,
      "block_env_file_modification": true,
      "block_env_file_deletion": true,
      "warn_on_env_access": true,
      "log_env_operations": true,
      "protect_existing_env_files": true
    },
    "directory_protection": {
      "protect_secrets_directory": true,
      "protect_git_directory": true,
      "protect_cursor_directory": true,
      "block_directory_creation": ["secrets", "private", "credentials"]
    }
  },
  "overwrite_protection": {
    "warn_on_overwrite": true,
    "backup_before_overwrite": true,
    "protected_from_overwrite": [
      ".env",
      ".env.*",
      "secrets/",
      "config/",
      ".git/",
      "node_modules/",
      ".cursor/mcp_security.json",
      ".cursor/mcp_audit.json"
    ],
    "auto_backup_directory": "backups/",
    "backup_retention_days": 30,
    "strict_overwrite_protection": true
  },
  "external_integration_restrictions": {
    "blocked_apis": [
      "file://",
      "ftp://",
      "sftp://",
      "smb://",
      "gopher://"
    ],
    "allowed_apis": [
      "https://api.openai.com",
      "https://api.anthropic.com",
      "https://api.groq.com",
      "https://api.google.com",
      "https://console.groq.com",
      "https://api.github.com",
      "https://huggingface.co"
    ],
    "require_authentication": true,
    "log_external_calls": true,
    "rate_limiting": {
      "enabled": true,
      "max_requests_per_minute": 60,
      "max_tokens_per_request": 4000
    }
  },
  "content_security": {
    "blocked_patterns": [
      "password\\s*=",
      "api_key\\s*=",
      "secret\\s*=",
      "token\\s*=",
      "credential\\s*=",
      "sk-[a-zA-Z0-9]{48}",
      "gsk_[a-zA-Z0-9]{48}",
      "[a-zA-Z0-9]{32,}"
    ],
    "sensitive_data_patterns": [
      "sk-[a-zA-Z0-9]{48}",
      "gsk_[a-zA-Z0-9]{48}",
      "[a-zA-Z0-9]{32,}",
      "\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b",
      "\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\b"
    ],
    "mask_sensitive_data": true,
    "log_sensitive_data_access": true,
    "prevent_sensitive_data_output": true
  },
  "audit_settings": {
    "log_all_operations": true,
    "log_file_path": "logs/security_audit.log",
    "log_level": "INFO",
    "retention_days": 90,
    "alert_on_violations": true,
    "real_time_monitoring": true
  },
  "compliance": {
    "gdpr_compliance": true,
    "data_retention_policy": "90_days",
    "encryption_required": true,
    "access_logging": true,
    "data_protection": {
      "encrypt_sensitive_data": true,
      "mask_credentials": true,
      "secure_transmission": true
    }
  },
  "auto_protection": {
    "auto_enable_on_startup": true,
    "auto_backup_configs": true,
    "auto_validate_settings": true,
    "auto_cleanup_logs": true,
    "auto_update_security": true,
    "auto_protect_existing_files": true
  },
  "mode_specific_settings": {
    "auto_mode": {
      "enabled": true,
      "strict_validation": true,
      "enhanced_logging": true
    },
    "claude_mode": {
      "enabled": true,
      "anthropic_compliance": true,
      "constitutional_ai": true
    },
    "gpt_mode": {
      "enabled": true,
      "openai_compliance": true,
      "content_filtering": true
    },
    "max_mode": {
      "enabled": true,
      "advanced_security": true,
      "real_time_protection": true
    }
  }
} 